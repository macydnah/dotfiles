# ~/.config/hypr/hyprland.conf

# Refer to the wiki for more information.
# https://wiki.hypr.land/Configuring/
# https://wiki.hypr.land/Hypr-Ecosystem/hyprlang/

# https://wiki.hypr.land/Hypr-Ecosystem/hyprlang/#defining-variables
$mod = SUPER
$terminal = footclient
$floatingTerminal = $terminal -a floating-foot -e tmux new-session -A -s Scratchpad
$fileManager = $terminal -a Yazi --title "ðŸ—‚  File Manager" bash -c "yazi"
# $fileManager = $terminal -a Yazi --title "ðŸ—‚  File Manager" bash -c "env YAZI_LOG=debug yazi"
$menu = ~/.config/rofi/launcher.sh
$bar = togglewaybar.sh
$editor = nvim

# https://wiki.hyprland.org/Configuring/Monitors/
# monitor = name, resolution, position, scale, transform, 0
# monitor = ,preferred,auto,auto,transform,0
# monitor = ,preferred,auto,1,mirror, LVDS-1
monitor = LVDS-1, 1366x768@60, 0x0, 1, transform, 0
# monitor = LVDS-1, disable
# monitor = VGA-1, 1680x1050@60, 1366x0, 1, transform, 1
# monitor = HDMI-A-1, 1680x1050@60, -1050x-912, 1, transform, 1
monitor = HDMI-A-1, 1680x1050@60, 1366x-912, 1, transform, 1
# monitor = HDMI-A-1, disable

# Plug-and-play any monitors not specified with an explicit rule
# automatically preferred resolution and placed on the right of the other(s)
monitor = , preferred, auto, 1

# https://wiki.hypr.land/Configuring/Keywords/#executing
exec-once = pcmanfm -d
exec-once = foot --server
exec-once = swaybg --output LVDS-1 --mode fill --image /usr/share/backgrounds/fgm.png
exec-once = swaybg --output HDMI-A-1 --mode fit --color 000000 --image /usr/share/backgrounds/pluto-portrait-enhanced-color.png
exec-once = $bar

# https://wiki.hypr.land/Configuring/Environment-variables/
# https://wiki.hypr.land/Configuring/Keywords/#setting-the-environment
env = TERMINAL,$terminal
env = EDITOR,$editor
env = BROWSER,firefox

env = GDK_BACKEND,wayland,x11,*
# env = QT_QPA_PLATFORM,wayland-egl
env = QT_QPA_PLATFORM,wayland;xcb
env = SDL_VIDEODRIVER,wayland
env = CLUTTER_BACKEND,wayland

env = _JAVA_AWT_WM_NONREPARENTING,1
env = _JAVA_OPTIONS,-Dawt.useSystemAAFontSettings=lcd

env = XDG_CURRENT_DESKTOP,Hyprland
env = XDG_SESSION_TYPE,wayland
env = XDG_SESSION_DESKTOP,Hyprland

env = QT_AUTO_SCREEN_SCALE_FACTOR,1
env = QT_WAYLAND_DISABLE_WINDOWDECORATION,1
# env = QT_QPA_PLATFORMTHEME,qt5ct

# env = GTK_THEME,Adwaita
env = XCURSOR_THEME,McMojave
env = XCURSOR_SIZE,24
env = HYPRCURSOR_SIZE,24

# https://wiki.archlinux.org/title/Hardware_video_acceleration#Configuring_VA-API
env = LIBVA_DRIVER_NAME,i965
env = LIBVA_DRIVERS_PATH,/usr/lib/dri

# https://wiki.hyprland.org/Configuring/Variables/#general
general {
	border_size = 1
	gaps_in = 2
	gaps_out = 4
	gaps_workspaces = 40
	#col.inactive_border = rgba(595959aa)
	col.inactive_border = rgba(43485988)
	#col.active_border = rgba(97d01add) rgba(f7d01add) rgba(d72c1add) 45deg
	#col.active_border = rgba(97d01add) rgba(d72c1add) rgba(f7d01add) 45deg
	col.active_border = rgba(97d01add)
	layout = dwindle
	# https://wiki.hypr.land/Configuring/Tearing/
	allow_tearing = true

	# https://wiki.hypr.land/Configuring/Variables/#snap
	snap {
		enabled = true
		window_gap = 10
		monitor_gap = 10
		border_overlap = false
		respect_gaps = true
	}
}

# https://wiki.hyprland.org/Configuring/Variables/#decoration
decoration {
	rounding = 10
	rounding_power = 4.0
	active_opacity = 1.0
	inactive_opacity = 0.95
	fullscreen_opacity = 1.0
	dim_inactive = false
	dim_strength = 0.5
	dim_special = 0.2
	dim_around = 0.4
	# screen_shader = ~/.config/hypr/blue-light-filter.frag
	border_part_of_window = true

	# https://wiki.hyprland.org/Configuring/Variables/#blur
	blur {
		enabled = true
		size = 4
		passes = 1
		ignore_opacity = true
		xray = true
		noise = 0.0117
		contrast = 0.8916
		brightness = 0.8172
		vibrancy = 0.1696
		vibrancy_darkness = 0.0
		special = false
		popups = false
		input_methods = false
	}

	# https://wiki.hyprland.org/Configuring/Variables/#shadow
	shadow {
		enabled = true
		range = 4
		render_power = 4
		sharp = false
		ignore_window = true
		color = rgba(1a1a1aee)
		color_inactive = rgba(00000000)
		offset = 0, 0
		scale = 1.0
	}
}

# https://wiki.hyprland.org/Configuring/Variables/#animations
# file:///home/macydnah/.config/hypr/conf.d/bezier.conf
source = conf.d/bezier.conf
animations {
	enabled = true
	workspace_wraparound = false

	# https://wiki.hyprland.org/Configuring/Animations/
	animation = windowsIn, 1, 4, easeInOutExpo
	animation = windowsOut, 0, 4, default, popin 100%
	animation = windowsMove, 1, 4, easeOutExpo
	animation = layersIn, 1, 2, easeOutCirc
	animation = layersOut, 1, 4, easeOutExpo
	animation = fade, 1, 4, default
	animation = fadeIn, 1, 3, easeInBack
	animation = fadeOut, 1, 2, easeOutExpo
	animation = fadeSwitch, 1, 2, easeOutExpo
	animation = fadeShadow, 1, 2, easeOutExpo
	animation = fadeLayersIn, 1, 4, easeInSine
	animation = fadeLayersOut, 1, 4, easeOutExpo
	animation = border, 0, 2, easeOutExpo
	animation = borderangle, 0, 8, easeInOutExpo, once
	animation = workspaces, 1, 6, default, slide
	# animation = workspacesIn, 1, 6, easeOutBack, slide
	# animation = workspacesOut, 1, 6, easeOutBack, fade
	animation = specialWorkspace, 1, 5, overshot, slidevert
}

# https://wiki.hyprland.org/Configuring/Variables/#input
input {
	# XKB Settings, see file:///usr/share/X11/xkb/rules/base.lst
	# and https://wiki.hypr.land/Configuring/Variables/#xkb-settings
	kb_model = pc104
	kb_layout = us
	kb_variant = altgr-intl
	kb_options =
	kb_rules =
	kb_file =

	# Keyboard
	numlock_by_default = false
	resolve_binds_by_sym = false
	repeat_rate = 25
	repeat_delay = 600

	# Mouse
	sensitivity = 0.0
	accel_profile = adaptive
	force_no_accel = false
	left_handed = false
	scroll_method = 2fg
	follow_mouse = 2
	off_window_axis_events = 0

	# https://wiki.hyprland.org/Configuring/Variables/#touchpad
	touchpad {
		disable_while_typing = true
		natural_scroll = true
		scroll_factor = 1.3
		middle_button_emulation = false
		tap_button_map = lrm
		clickfinger_behavior = true
		tap-to-click = true
		drag_lock = 2
		tap-and-drag = true
		flip_x = false
		flip_y = false
		drag_3fg = 0
	}
}

# https://wiki.hyprland.org/Configuring/Variables/#gestures
gestures {
	workspace_swipe_distance = 150
	workspace_swipe_touch = false
	workspace_swipe_invert = true
	workspace_swipe_touch_invert = false
	workspace_swipe_min_speed_to_force = 0
	workspace_swipe_cancel_ratio = 0.0
	workspace_swipe_create_new = false

	# https://wiki.hypr.land/Configuring/Gestures/
	# gesture = 3, horizontal, workspace
	# gesture = 3, up, special, magic
}

# https://wiki.hyprland.org/Configuring/Variables/#group
group {
	auto_group = true
	insert_after_current = true
	focus_removed_window = true
	drag_into_group = 2
	merge_groups_on_drag = false
	merge_groups_on_groupbar = false
	merge_floated_into_tiled_on_groupbar = false
	col.border_active = rgba(97d01add)
	col.border_inactive = rgba(43485988)

	# https://wiki.hyprland.org/Configuring/Variables/#groupbar
	groupbar {
		enabled = true
		font_family = SF Pro Display
		font_size = 14
		font_weight_active = normal
		font_weight_inactive = ultralight
		gradients = true
		height = 14
		indicator_gap = 0
		indicator_height = 0
		stacked = false
		render_titles = true
		text_offset = 0
		scrolling = false
		rounding = 4
		rounding_power = 2.0
		gradient_rounding = 10
		gradient_rounding_power = 4.0
		round_only_edges = false
		gradient_round_only_edges = true
		text_color = rgba(000000dd)
		text_color_inactive = rgba(ffffff66)
		col.active = rgba(97d01add)
		col.inactive = rgba(43485955)
		gaps_in = 0
		gaps_out = 0
		keep_upper_gap = false
	}
}

# https://wiki.hyprland.org/Configuring/Variables/#misc
misc {
	disable_hyprland_logo = true
	disable_splash_rendering = true
	col.splash = rgba(ffffffff)
	font_family = SF Pro Display
	splash_font_family = SF Pro Display
	force_default_wallpaper = -1
	vfr = true # https://github.com/hyprwm/hyprland-wiki/issues/193
	vrr = 0
	mouse_move_enables_dpms = true
	key_press_enables_dpms = true
	animate_manual_resizes = false
	animate_mouse_windowdragging = false
	disable_autoreload = false
	enable_swallow = false
	swallow_regex = ^(footclient)$
	#swallow_exception_regex = ^()$
	mouse_move_focuses_monitor = true
	background_color = rgba(000000ff)
	close_special_on_empty = true
	on_focus_under_fullscreen = 1
	middle_click_paste = false
	render_unfocused_fps = 10
	enable_anr_dialog = false
	anr_missed_pings = 1
}

# https://wiki.hyprland.org/Configuring/Variables/#binds
binds {
	workspace_back_and_forth = false
	hide_special_on_workspace_change = false
	allow_workspace_cycles = true
	movefocus_cycles_fullscreen = true
	movefocus_cycles_groupfirst = true
	window_direction_monitor_fallback = true
}

# https://wiki.hypr.land/Configuring/Variables/#xwayland
xwayland {
	enabled = true
	use_nearest_neighbor = true
	force_zero_scaling = false
	# https://wiki.hypr.land/Configuring/XWayland/#abstract-unix-domain-socket
	create_abstract_socket = false
}

# https://wiki.hyprland.org/Configuring/Variables/#opengl
opengl {
	nvidia_anti_flicker = false
}

# https://wiki.hypr.land/Configuring/Variables/#render
render {
	direct_scanout = 0
	expand_undersized_textures = true
	xp_mode = false
	ctm_animation = 2
	cm_fs_passthrough = 2
	cm_enabled = true
	send_content_type = false
	cm_auto_hdr = 0
}

# https://wiki.hyprland.org/Configuring/Variables/#cursor
cursor {
	invisible = false
	sync_gsettings_theme = true
	no_hardware_cursors = 1
	hotspot_padding = 5
	inactive_timeout = 2
	no_warps = false
	persistent_warps = true
	warp_on_change_workspace = 1
	warp_on_toggle_special = 0
	default_monitor = LVDS-1
	zoom_factor = 1.000
	zoom_rigid = false
	enable_hyprcursor = false
	hide_on_key_press = false
}

# https://wiki.hypr.land/Configuring/Variables/#ecosystem
ecosystem {
	no_update_news = true
	no_donation_nag = true
	enforce_permissions = false
}

# https://wiki.hyprland.org/Configuring/Dwindle-Layout/
dwindle {
	pseudotile = true
	force_split = 2
	preserve_split = true
	use_active_for_splits = true

	bind = $mod, P, pseudo
	bind = $mod, C, togglesplit
}

# https://wiki.hyprland.org/Configuring/Master-Layout/
master {
	new_status = master
}

####################
### KEYBINDINGS  ###
####################

# https://wiki.hyprland.org/Configuring/Binds/

# Media/Volume/Brightness Control
bind = ,XF86AudioPlay, exec, mpc toggle
bind = ,XF86AudioPause, exec, mpc pause
bind = ,XF86AudioNext, exec, mpc next
bind = ,XF86AudioPrev, exec, mpc cdprev
bind = ,XF86AudioMute, exec, volfade-rs toggle-mute
bind = ,XF86AudioRaiseVolume, exec, volfade-rs increase 11
bind = ,XF86AudioLowerVolume, exec, volfade-rs decrease 7
bind = SHIFT, XF86AudioRaiseVolume, exec, volfade-rs inc 1
bind = SHIFT, XF86AudioLowerVolume, exec, volfade-rs dec 1
bind = $mod, XF86AudioRaiseVolume, exec, pavucontrol --tab=3
bind = $mod, XF86AudioLowerVolume, exec, $terminal --title 'Volume Control' -- alsamixer
binde = ,XF86MonBrightnessUp, exec, xbacklight -inc 3 -fps 60 -time 111 -perceived
binde = ,XF86MonBrightnessDown, exec, xbacklight -dec 3 -fps 60 -time 111 -perceived
bind = SHIFT, XF86MonBrightnessUp, exec, hyprctl keyword decoration:screen_shader ' '
bind = SHIFT, XF86MonBrightnessDown, exec, hyprctl keyword decoration:screen_shader ~/.config/hypr/blue-light-filter.frag
bind = $mod, XF86MonBrightnessUp, exec, hyprctl dispatch dpms on
bind = $mod, XF86MonBrightnessDown, exec, sleep 1 && hyprctl dispatch dpms off
# regarding sleep(1), see https://github.com/hyprwm/Hyprland/issues/2954
bind = $mod, F7, exec, sleep 1 && hyprctl dispatch dpms toggle
bind = $mod, Menu, exec, kblight

# Keybinds/shortcuts for applications
bind = $mod, Return, exec, $terminal
bind = $mod, grave, togglespecialworkspace, magic
bind = $mod, A, exec, $menu
bind = $mod, B, exec, $bar
bind = $mod, E, exec, $fileManager
bind = $mod, N, exec, networkmanager_dmenu
bind = $mod, S, exec, $terminal -- $editor -c ':source ~/.config/vim/simplenoterc.vim | :SimplenoteList'
bind = $mod SHIFT, C, exec, $terminal -D ~/.dotfiles -- $editor -c ':lua FzfLua.files({ winopts={fullscreen=true} })'
bind = $mod SHIFT, P, exec, $terminal -D ~/Documents/TeX/PRIMA_VERA_INTER_TERRA_EX_MACHINA -- $editor -c ':e main.tex | :badd epÃ­grafe.tex | :badd cantos/canto1.tex | :badd cantos/canto2.tex | :FzfLua files hidden=false winopts.fullscreen=true cwd_prompt=false prompt=PVITEM/ preview="bat --theme=auto:always -p"'
bind = SHIFT, Print, exec, grimblast save area ~/Pictures/Screenshots/$(date +%Y-%m-%d_%s).png
bind = , Print, exec, grimblast save output ~/Pictures/Screenshots/$(date +%Y-%m-%d_%s).png

# Window manager functions
bind = $mod, Q, killactive
bind = $mod, F, fullscreen, 0
bind = $mod, Tab, workspace, previous
bind = $mod, space, togglefloating,
bind = $mod, X, exec, togglehyprtab.sh 
bind = $mod SHIFT, R, exec, hyprctl reload
bind = $mod SHIFT, Escape, exec, hyprctl dispatcher exit

# Submap: For a global unbinded environment
bind = SUPER ALT CTRL SHIFT, Return, submap, nobindings
submap = nobindings
bind = SUPER ALT CTRL SHIFT, Return, submap, reset
submap = reset
# keybinds further down will be global again...

# Submap: Resize
bind = $mod, R, submap, resize
submap = resize
	binde = , H, resizeactive, -10 0
	binde = , J, resizeactive, 0 10
	binde = , K, resizeactive, 0 -10
	binde = , L, resizeactive, 10 0
	binde = SHIFT, H, resizeactive, -66 0
	binde = SHIFT, J, resizeactive, 0 66
	binde = SHIFT, K, resizeactive, 0 -66
	binde = SHIFT, L, resizeactive, 66 0
	bind = , Escape, submap, reset
	bind = , Return, submap, reset
	bind = CTRL, bracketleft, submap, reset
	bind = CTRL, C, submap, reset
submap = reset
# keybinds further down will be global again...

# Navigation
bind = $mod, H, movefocus, l
bind = $mod, J, movefocus, d
bind = $mod, K, movefocus, u
bind = $mod, L, movefocus, r
bind = $mod SHIFT, H, movewindoworgroup, l
bind = $mod SHIFT, J, movewindoworgroup, d
bind = $mod SHIFT, K, movewindoworgroup, u
bind = $mod SHIFT, L, movewindoworgroup, r
bind = $mod CTRL, H, movegroupwindow, b
bind = $mod CTRL, L, movegroupwindow
bindm = $mod, mouse:272, movewindow
bindm = $mod, mouse:273, resizewindow

bind = $mod, 1, workspace, 1
bind = $mod, 2, workspace, 2
bind = $mod, 3, workspace, 3
bind = $mod, 4, workspace, 4
bind = $mod, 5, workspace, 5
bind = $mod, 6, workspace, 6
bind = $mod, 7, workspace, 7
bind = $mod, 8, workspace, 8
bind = $mod, 9, workspace, 9
bind = $mod, 0, workspace, 10

bind = $mod SHIFT, 1, movetoworkspace, 1
bind = $mod SHIFT, 2, movetoworkspace, 2
bind = $mod SHIFT, 3, movetoworkspace, 3
bind = $mod SHIFT, 4, movetoworkspace, 4
bind = $mod SHIFT, 5, movetoworkspace, 5
bind = $mod SHIFT, 6, movetoworkspace, 6
bind = $mod SHIFT, 7, movetoworkspace, 7
bind = $mod SHIFT, 8, movetoworkspace, 8
bind = $mod SHIFT, 9, movetoworkspace, 9
bind = $mod SHIFT, 0, movetoworkspace, 10
bind = $mod SHIFT, grave, movetoworkspacesilent, special:magic

#############
### RULES ###
#############

# https://wiki.hyprland.org/Configuring/Window-Rules/#rules
# https://wiki.hyprland.org/Configuring/Window-Rules/#layer-rules
# https://wiki.hyprland.org/Configuring/Workspace-Rules/#workspace-rules

# Global Rules
windowrule = suppress_event maximize, match:class .*
workspace = special:magic, on-created-empty:$floatingTerminal, border:true

# Monitor Rules
workspace = m[HDMI-A-1], gapsin:8, gapsout:16, bordersize:1
# workspace = 1, monitor:HDMI-A-1, default:true
# workspace = 2, monitor:HDMI-A-1
# workspace = 3, monitor:HDMI-A-1
# workspace = 4, monitor:HDMI-A-1
# workspace = 5, monitor:HDMI-A-1
# workspace = 6, monitor:LVDS-1
# workspace = 7, monitor:LVDS-1
# workspace = 8, monitor:LVDS-1
# workspace = 9, monitor:LVDS-1
# workspace = 10, monitor:LVDS-1, default:true
workspace = 1, monitor:LVDS-1, default:true
workspace = 2, monitor:LVDS-1
workspace = 3, monitor:LVDS-1
workspace = 4, monitor:LVDS-1
workspace = 5, monitor:LVDS-1
workspace = 6, monitor:HDMI-A-1
workspace = 7, monitor:HDMI-A-1
workspace = 8, monitor:HDMI-A-1
workspace = 9, monitor:HDMI-A-1
workspace = 10, monitor:HDMI-A-1, default:true

# firefoxd
workspace = special:firefoxd, on-created-empty:firefox --new-window about:blank
bind = , XF86Launch2, togglespecialworkspace, firefoxd

# floating-editor
windowrule {
	name = floating-editor
	match:class = ^(floating-editor)$

	size = 675 364
	float = on
	center = on
	stay_focused = on
}

# floating-foot
windowrule {
	name = floating-foot
	match:class = ^(floating-foot)$

	size = 675 364
	float = on
	pseudo = on
	tile = on
	no_shadow = 1
}

# java windows
# https://www.reddit.com/r/hyprland/comments/16rwbun/comment/k2f0nco/?utm_source=share&utm_medium=web3x&utm_name=web3xcss&utm_term=1&utm_content=share_button
windowrule {
	name = NetBeans
	match:class = ^(Apache NetBeans IDE 26)$
	match:float = 1
	match:fullscreen = 0

	stay_focused = off
}
windowrule {
	name = BurpSuite
	match:class = ^(burp-StartBurp)$
	match:float = 1
	match:fullscreen = 0

	stay_focused = off
}

# mpv
windowrule {
	name = mpv
	match:class = ^(mpv)$

	no_blur = 1
	no_dim = 1
	no_shadow = 1
	opaque = 1
	force_rgbx = 1
	immediate = 1
	xray = 0
}

# pavucontrol
windowrule {
	name = pavucontrol
	match:class = ^(org.pulseaudio.pavucontrol)$

	size = 675 364
	float = on
	center = on
}

# pcmanfm (Copying files dialog)
windowrule {
	name = pcmanfm (Copying files dialog)
	match:class = ^(pcmanfm)$
	match:title = ^(Copying files)$

	size = 675 264
	float = on
	center = on
	stay_focused = off
}

# rofi
layerrule {
	name = rofi
	match:namespace = rofi

	blur = on
	ignore_alpha = 0
	dim_around = on
	xray = 1
	animation = popin
}

# scrcpy
# windowrule {
# 	name = scrcpy
# 	match:class = ^(scrcpy)$
# 	match:title = ^(SM-G935F)$
#
# 	size = (monitor_w*0.32) (monitor_h*0.99)
# 	tile = on
# 	pseudo = on
# }

# smart gaps
source = conf.d/smart-gaps.conf

# swayimg
# windowrule {
# 	name = swayimg
# 	match:class = ^(swayimg.*)$
#
# 	immediate = 1
# }

# Unlock Login Keyring
windowrule {
	name = Unlock Login Keyring
	match:class = ^(gcr-prompter)$
	match:float = 1
	match:fullscreen = 0

	stay_focused = on
}

# waybar
layerrule {
	name = waybar
	match:namespace = waybar

	blur = on
	blur_popups = on
	ignore_alpha = 0
	animation = slide
	xray = 1
}

# V4L2 Viewer
windowrule {
	name = V4L2 Viewer (WebCam)
	match:class = ^(qvidcap)$
	match:title = ^(V4L2 Viewer)$

	size = 640 480
	opaque = on
	force_rgbx = on
	no_blur = on
	no_dim = on
	no_shadow = on
	xray = off

	pseudo = on

	# float = on
	# center = on
	# pin = on
}

# Battery friendly config patches
# source = conf.d/battery-friendly.conf

# vim: ft=hyprlang ts=4 sts=0 sw=4 noet ai
